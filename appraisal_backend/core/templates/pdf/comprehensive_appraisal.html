<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Comprehensive Appraisal Report</title>

    <style>
        @page {
            size: A4;
            margin: 15mm 12mm;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 11px;
            line-height: 1.4;
        }

        h1,
        h2,
        h3,
        h4 {
            text-align: center;
            margin: 6px 0;
            color: #1a1a1a;
        }

        h1 {
            font-size: 18px;
        }

        h2 {
            font-size: 16px;
        }

        h3 {
            font-size: 14px;
        }

        h4 {
            font-size: 12px;
            font-weight: bold;
            margin-top: 12px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
            margin-bottom: 8px;
        }

        th,
        td {
            border: 1px solid #000;
            padding: 4px;
            vertical-align: top;
        }

        th {
            background-color: #f0f0f0;
            font-weight: bold;
            text-align: center;
        }

        .center {
            text-align: center;
        }

        .right {
            text-align: right;
        }

        .bold {
            font-weight: bold;
        }

        .page-break {
            page-break-before: always;
        }

        .section-header {
            background-color: #e0e0e0;
            padding: 6px;
            margin-top: 10px;
            margin-bottom: 6px;
            font-weight: bold;
            font-size: 13px;
        }

        .info-table td {
            padding: 3px 6px;
        }

        .score-summary {
            background-color: #f9f9f9;
            padding: 8px;
            margin-top: 10px;
            border: 2px solid #333;
        }

        .total-score {
            font-size: 16px;
            font-weight: bold;
            color: #0066cc;
            text-align: center;
            padding: 8px;
            background-color: #e6f2ff;
            border: 2px solid #0066cc;
            margin-top: 10px;
        }

        .yes {
            color: green;
            font-weight: bold;
        }

        .no {
            color: red;
        }
    </style>
</head>

<body>

    <!-- ================= HEADER ================= -->
    <h1>Savitribai Phule Pune University, Pune</h1>
    <h2>Modern Education Society's</h2>
    <h1>Wadia College of Engineering, Pune â€“ 01</h1>

    <h3>COMPREHENSIVE APPRAISAL REPORT</h3>
    <h3>Academic Year: {{ academic_year }} | Semester: {{ semester }} | Form Type: {{ form_type }}</h3>

    <hr style="margin: 10px 0; border: 1px solid #333;">

    <!-- ================= FACULTY INFORMATION ================= -->
    <div class="section-header">FACULTY INFORMATION</div>

    <table class="info-table">
        <tr>
            <td style="width: 30%;"><b>Name:</b></td>
            <td style="width: 70%;">{{ faculty.name }}</td>
        </tr>
        <tr>
            <td><b>Designation:</b></td>
            <td>{{ faculty.designation }}</td>
        </tr>
        <tr>
            <td><b>Department:</b></td>
            <td>{{ faculty.department }}</td>
        </tr>
        <tr>
            <td><b>Email:</b></td>
            <td>{{ faculty.email }}</td>
        </tr>
        <tr>
            <td><b>Mobile:</b></td>
            <td>{{ faculty.mobile }}</td>
        </tr>
    </table>

    <!-- ================= TEACHING DETAILS ================= -->
    <div class="section-header">TEACHING DETAILS</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 20%;">Semester</th>
                <th style="width: 15%;">Course Code</th>
                <th style="width: 27%;">Course Name</th>
                <th style="width: 15%;">Scheduled Classes</th>
                <th style="width: 15%;">Held Classes</th>
            </tr>
        </thead>
        <tbody>
            {% for course in teaching.courses %}
            <tr>
                <td class="center">{{ forloop.counter }}</td>
                <td>{{ course.semester }}</td>
                <td class="center">{{ course.course_code }}</td>
                <td>{{ course.course_name }}</td>
                <td class="center">{{ course.scheduled_classes }}</td>
                <td class="center">{{ course.held_classes }}</td>
            </tr>
            {% endfor %}
            <tr style="background-color: #f0f0f0;">
                <td colspan="4" class="right bold">TOTAL:</td>
                <td class="center bold">{{ teaching.total_scheduled }}</td>
                <td class="center bold">{{ teaching.total_held }}</td>
            </tr>
            <tr style="background-color: #f0f0f0;">
                <td colspan="4" class="right bold">ATTENDANCE PERCENTAGE:</td>
                <td colspan="2" class="center bold">{{ teaching.attendance_percentage }}%</td>
            </tr>
        </tbody>
    </table>

    <!-- ================= ACTIVITIES ================= -->
    <div class="section-header">ACTIVITIES</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 62%;">Activity Type</th>
                <th style="width: 30%;">Status</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="center">1</td>
                <td>Administrative Responsibility</td>
                <td class="center {% if activities.administrative_responsibility %}yes{% else %}no{% endif %}">
                    {% if activities.administrative_responsibility %}YES{% else %}NO{% endif %}
                </td>
            </tr>
            <tr>
                <td class="center">2</td>
                <td>Exam Duties</td>
                <td class="center {% if activities.exam_duties %}yes{% else %}no{% endif %}">
                    {% if activities.exam_duties %}YES{% else %}NO{% endif %}
                </td>
            </tr>
            <tr>
                <td class="center">3</td>
                <td>Student Related Activities</td>
                <td class="center {% if activities.student_related %}yes{% else %}no{% endif %}">
                    {% if activities.student_related %}YES{% else %}NO{% endif %}
                </td>
            </tr>
            <tr>
                <td class="center">4</td>
                <td>Organizing Events</td>
                <td class="center {% if activities.organizing_events %}yes{% else %}no{% endif %}">
                    {% if activities.organizing_events %}YES{% else %}NO{% endif %}
                </td>
            </tr>
            <tr>
                <td class="center">5</td>
                <td>PhD Guidance</td>
                <td class="center {% if activities.phd_guidance %}yes{% else %}no{% endif %}">
                    {% if activities.phd_guidance %}YES{% else %}NO{% endif %}
                </td>
            </tr>
            <tr>
                <td class="center">6</td>
                <td>Research Project</td>
                <td class="center {% if activities.research_project %}yes{% else %}no{% endif %}">
                    {% if activities.research_project %}YES{% else %}NO{% endif %}
                </td>
            </tr>
            <tr>
                <td class="center">7</td>
                <td>Sponsored Project</td>
                <td class="center {% if activities.sponsored_project %}yes{% else %}no{% endif %}">
                    {% if activities.sponsored_project %}YES{% else %}NO{% endif %}
                </td>
            </tr>
        </tbody>
    </table>

    <!-- ================= RESEARCH ================= -->
    <div class="section-header">RESEARCH & PUBLICATIONS</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 25%;">Type</th>
                <th style="width: 10%;">Count</th>
                <th style="width: 32%;">Title</th>
                <th style="width: 10%;">Year</th>
                <th style="width: 15%;">Enclosure No.</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in research.entries %}
            <tr>
                <td class="center">{{ forloop.counter }}</td>
                <td>{{ entry.type }}</td>
                <td class="center">{{ entry.count }}</td>
                <td>{{ entry.title|default:"-" }}</td>
                <td class="center">{{ entry.year|default:"-" }}</td>
                <td class="center">{{ entry.enclosure_no|default:"-" }}</td>
            </tr>
            {% endfor %}
            {% if research.entries|length == 0 %}
            <tr>
                <td colspan="6" class="center">No research entries</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <!-- ================= PBAS SECTIONS ================= -->
    <div class="page-break"></div>

    <div class="section-header">PBAS - STUDENT FEEDBACK</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 20%;">Semester</th>
                <th style="width: 15%;">Course Code</th>
                <th style="width: 32%;">Course Name</th>
                <th style="width: 15%;">Feedback Score</th>
                <th style="width: 10%;">Enclosure</th>
            </tr>
        </thead>
        <tbody>
            {% for feedback in pbas.student_feedback %}
            <tr>
                <td class="center">{{ forloop.counter }}</td>
                <td>{{ feedback.semester }}</td>
                <td class="center">{{ feedback.course_code }}</td>
                <td>{{ feedback.course_name }}</td>
                <td class="center">{{ feedback.feedback_score }}</td>
                <td class="center">{{ feedback.enclosure_no }}</td>
            </tr>
            {% endfor %}
            {% if pbas.student_feedback|length == 0 %}
            <tr>
                <td colspan="6" class="center">No student feedback entries</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="section-header">PBAS - DEPARTMENTAL ACTIVITIES</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 42%;">Activity</th>
                <th style="width: 20%;">Semester</th>
                <th style="width: 15%;">Credits Claimed</th>
                <th style="width: 15%;">Enclosure</th>
            </tr>
        </thead>
        <tbody>
            {% for activity in pbas.departmental_activities %}
            <tr>
                <td class="center">{{ forloop.counter }}</td>
                <td>{{ activity.activity }}</td>
                <td>{{ activity.semester }}</td>
                <td class="center">{{ activity.credits_claimed }}</td>
                <td class="center">{{ activity.enclosure_no }}</td>
            </tr>
            {% endfor %}
            {% if pbas.departmental_activities|length == 0 %}
            <tr>
                <td colspan="5" class="center">No departmental activities</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="section-header">PBAS - INSTITUTE ACTIVITIES</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 42%;">Activity</th>
                <th style="width: 20%;">Semester</th>
                <th style="width: 15%;">Credits Claimed</th>
                <th style="width: 15%;">Enclosure</th>
            </tr>
        </thead>
        <tbody>
            {% for activity in pbas.institute_activities %}
            <tr>
                <td class="center">{{ forloop.counter }}</td>
                <td>{{ activity.activity }}</td>
                <td>{{ activity.semester }}</td>
                <td class="center">{{ activity.credits_claimed }}</td>
                <td class="center">{{ activity.enclosure_no }}</td>
            </tr>
            {% endfor %}
            {% if pbas.institute_activities|length == 0 %}
            <tr>
                <td colspan="5" class="center">No institute activities</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="section-header">PBAS - SOCIETY ACTIVITIES</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 42%;">Activity</th>
                <th style="width: 20%;">Semester</th>
                <th style="width: 15%;">Credits Claimed</th>
                <th style="width: 15%;">Enclosure</th>
            </tr>
        </thead>
        <tbody>
            {% for activity in pbas.society_activities %}
            <tr>
                <td class="center">{{ forloop.counter }}</td>
                <td>{{ activity.activity }}</td>
                <td>{{ activity.semester }}</td>
                <td class="center">{{ activity.credits_claimed }}</td>
                <td class="center">{{ activity.enclosure_no }}</td>
            </tr>
            {% endfor %}
            {% if pbas.society_activities|length == 0 %}
            <tr>
                <td colspan="5" class="center">No society activities</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <!-- ================= ACR GRADE ================= -->
    <div class="section-header">ACR (ANNUAL CONFIDENTIAL REPORT)</div>

    <table>
        <tr>
            <td style="width: 30%; background-color: #f0f0f0;"><b>ACR Grade:</b></td>
            <td style="width: 70%;">{{ acr.grade|default:"-" }}</td>
        </tr>
    </table>

    <!-- ================= CALCULATED SCORES ================= -->
    <div class="section-header">CALCULATED SCORES SUMMARY</div>

    <table>
        <thead>
            <tr>
                <th style="width: 8%;">Sr. No.</th>
                <th style="width: 62%;">Category</th>
                <th style="width: 30%;">Score</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="center">1</td>
                <td>Teaching Score</td>
                <td class="center bold">{{ scores.teaching_score }}</td>
            </tr>
            <tr>
                <td class="center">2</td>
                <td>Activities Score</td>
                <td class="center bold">{{ scores.activities_score }}</td>
            </tr>
            <tr>
                <td class="center">3</td>
                <td>Student Feedback Score</td>
                <td class="center bold">{{ scores.student_feedback_score }}</td>
            </tr>
            <tr>
                <td class="center">4</td>
                <td>Departmental Activities Score</td>
                <td class="center bold">{{ scores.departmental_score }}</td>
            </tr>
            <tr>
                <td class="center">5</td>
                <td>Institute Activities Score</td>
                <td class="center bold">{{ scores.institute_score }}</td>
            </tr>
            <tr>
                <td class="center">6</td>
                <td>Society Activities Score</td>
                <td class="center bold">{{ scores.society_score }}</td>
            </tr>
            <tr>
                <td class="center">7</td>
                <td>Research Score</td>
                <td class="center bold">{{ scores.research_score }}</td>
            </tr>
            <tr>
                <td class="center">8</td>
                <td>PBAS Score</td>
                <td class="center bold">{{ scores.pbas_score }}</td>
            </tr>
            <tr>
                <td class="center">9</td>
                <td>ACR Score</td>
                <td class="center bold">{{ scores.acr_score }}</td>
            </tr>
        </tbody>
    </table>

    <div class="total-score">
        TOTAL SCORE: {{ scores.total_score }}
    </div>

    <!-- ================= SIGNATURES ================= -->
    <br><br>
    <table style="border:none; margin-top: 20px;">
        <tr>
            <td style="border:none; width: 33%;">
                <b>Faculty Signature:</b><br><br>
                ____________________<br>
                Date: ______________
            </td>
            <td style="border:none; width: 33%; text-align: center;">
                <b>HOD Signature:</b><br><br>
                ____________________<br>
                Date: ______________
            </td>
            <td style="border:none; width: 33%; text-align: right;">
                <b>Principal Signature:</b><br><br>
                ____________________<br>
                Date: ______________
            </td>
        </tr>
    </table>

</body>

</html>